USE Lab4;

--5.1

SELECT  од—ырь€,Ќаим—ырь€ FROM —ырье
	WHERE —ырье. од—ырь€ = any
	(SELECT  од—ырь€ FROM —клад)
	ORDER BY  од—ырь€;

	SELECT  од—ырь€ 
		FROM —ырье
			WHERE  од—ырь€  IN
			(SELECT  од—ырь€ FROM —клад WHERE  —ырье. од—ырь€ = —клад. од—ырь€)
			ORDER BY   од—ырь€;


	SELECT —ырье. од—ырь€,—ырье.Ќаим—ырь€,—клад. од—ырь€
		FROM —ырье
			LEFT OUTER JOIN —клад ON —ырье. од—ырь€ = —клад. од—ырь€
				WHERE —клад. од—ырь€ IS NOT NULL
			GROUP BY —ырье. од—ырь€,—ырье.Ќаим—ырь€,—клад. од—ырь€
		ORDER BY —ырье. од—ырь€;
--5.2

SELECT  од—ырь€,Ќаим—ырь€ FROM —ырье
	WHERE —ырье. од—ырь€ != all
	(SELECT  од—ырь€ FROM —клад)
	ORDER BY  од—ырь€;


	SELECT  од—ырь€ 
		FROM —ырье
			WHERE  од—ырь€ NOT IN
			(SELECT  од—ырь€ FROM —клад WHERE  —ырье. од—ырь€ = —клад. од—ырь€)
			ORDER BY   од—ырь€;


	SELECT —ырье. од—ырь€,—ырье.Ќаим—ырь€,—клад. од—ырь€
		FROM —ырье
			LEFT OUTER JOIN —клад ON —ырье. од—ырь€ = —клад. од—ырь€
				WHERE —клад. од—ырь€ IS NULL
			GROUP BY —ырье. од—ырь€,—ырье.Ќаим—ырь€,—клад. од—ырь€
		ORDER BY —ырье. од—ырь€;
--5.3
--USE Lab4;
SELECT Ќаим—ырь€, од“ипа—ырь€, од≈д»зм,MAX(÷ена—ырь€) AS макс_цена,AVG(÷ена—ырь€) AS ср_цена
	FROM [—ырье]
		GROUP BY CUBE(Ќаим—ырь€, од“ипа—ырь€, од≈д»зм)
		ORDER BY  од“ипа—ырь€, од≈д»зм,Ќаим—ырь€;
--5.4

SELECT  од—ырь€,SUM( оличество) AS ќбъем
	FROM [—клад]
		WHERE  од—клада = 1 AND YEAR(ƒатадвижени€) = 2002
			GROUP BY  од—ырь€ WITH ROLLUP
				ORDER BY  од—ырь€;