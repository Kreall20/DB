USE Lab4;

--6.1



--6.2

SELECT —ырье.Ќаим—ырь€,—ырье.÷ена—ырь€,
≈д_изм.Ќаим≈д»зм AS ≈д_изм FROM [≈д_изм]
	RIGHT OUTER JOIN [—ырье] ON ≈д_изм. од≈д»зм = —ырье. од≈д»зм
		WHERE —ырье. од≈д»зм IS NULL
			GROUP BY —ырье.Ќаим—ырь€,—ырье.÷ена—ырь€,≈д_изм.Ќаим≈д»зм;

SELECT * FROM —ырье
WHERE  од≈д»зм IS NULL;

SELECT —ырье.Ќаим—ырь€,—ырье.÷ена—ырь€,
≈д_изм.Ќаим≈д»зм AS ≈д_изм FROM [≈д_изм]
	LEFT OUTER JOIN [—ырье] ON —ырье. од≈д»зм = ≈д_изм. од≈д»зм
		WHERE —ырье. од≈д»зм IS NULL
			GROUP BY —ырье.Ќаим—ырь€,—ырье.÷ена—ырь€,≈д_изм.Ќаим≈д»зм,—ырье. од≈д»зм;

SELECT —ырье.Ќаим—ырь€,—ырье.÷ена—ырь€,≈д_изм.Ќаим≈д»зм AS ≈д_изм FROM [≈д_изм]
	FULL OUTER JOIN [—ырье] ON ≈д_изм. од≈д»зм = —ырье. од≈д»зм
			GROUP BY —ырье.Ќаим—ырь€,—ырье.÷ена—ырь€,≈д_изм.Ќаим≈д»зм;

--6.3

SELECT “ипы_сырь€.Ќаим“ипа—ырь€,—ырье.Ќаим—ырь€,—клад.÷ена,
	—клад. оличество,CONVERT(varchar(12), —клад.ƒатадвижени€, 101) AS ƒата FROM —ырье
		INNER JOIN “ипы_сырь€ ON “ипы_сырь€. од“ипа—ырь€ = —ырье. од“ипа—ырь€
		INNER JOIN —клад ON —клад. од—ырь€ = —ырье. од—ырь€
			WHERE YEAR(—клад.ƒатадвижени€) = 2003 AND —клад. од—клада = 1 AND ѕризнакƒвижени€ = N'ѕоступление'
				ORDER BY —ырье.Ќаим—ырь€;

--6.4
SELECT —писок_складов.Ќаим—клада,
	DATEPART(WEEK, —клад.ƒатадвижени€) AS Ќедел€,
	COUNT(—клад. оличество) AS  о_во
	FROM —клад 
		INNER JOIN —ырье ON —клад. од—ырь€ = —ырье. од—ырь€
		INNER JOIN —писок_складов ON —писок_складов. од—клада = —клад. од—кладаƒвиж
			WHERE —ырье. од“ипа—ырь€ = 9 AND YEAR(—клад.ƒатадвижени€) = 2003 AND —клад.ѕризнакƒвижени€ = N'ѕоступление' AND DATEPART(WEEK, —клад.ƒатадвижени€) % 2 = 0
				GROUP BY —писок_складов.Ќаим—клада,DATEPART(WEEK, —клад.ƒатадвижени€)
			ORDER BY —писок_складов.Ќаим—клада,Ќедел€;











	SELECT —писок_складов.Ќаим—клада,
	DATEPART(DAYOFYEAR, —клад.ƒатадвижени€) / 7 + 1 AS Ќедел€,
	COUNT(—клад. оличество) AS  о_во
	FROM —клад 
		INNER JOIN —ырье ON —клад. од—ырь€ = —ырье. од—ырь€
		INNER JOIN —писок_складов ON —писок_складов. од—клада = —клад. од—кладаƒвиж
			WHERE —ырье. од“ипа—ырь€ = 9 AND YEAR(—клад.ƒатадвижени€) = 2003 AND —клад.ѕризнакƒвижени€ = N'ѕоступление' AND ((DATEPART(DAYOFYEAR, —клад.ƒатадвижени€) / 7) + 1) % 2 = 0
				GROUP BY —писок_складов.Ќаим—клада,DATEPART(DAYOFYEAR, —клад.ƒатадвижени€) / 7 + 1
			ORDER BY —писок_складов.Ќаим—клада,Ќедел€;

			SELECT —писок_складов.Ќаим—клада AS —клад,
	DATEPART(DAYOFYEAR, —клад.ƒатадвижени€) / 7 + 1 AS Ќедел€,
	COUNT(—клад. оличество) AS  оличество FROM —клад
	INNER JOIN —писок_складов ON —клад. од—кладаƒвиж = —писок_складов. од—клада
	INNER JOIN —ырье ON —клад. од—ырь€ = —ырье. од—ырь€
	WHERE —ырье. од“ипа—ырь€ = 9 AND YEAR(—клад.ƒатадвижени€) = 2003
		AND —клад.ѕризнакƒвижени€ = N'ѕоступление'
	GROUP BY —писок_складов.Ќаим—клада, DATEPART(DAYOFYEAR, —клад.ƒатадвижени€) / 7 + 1
	HAVING ((DATEPART(DAYOFYEAR, —клад.ƒатадвижени€) / 7) + 1) % 2 = 0
	ORDER BY —писок_складов.Ќаим—клада ASC;